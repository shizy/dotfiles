#!/bin/bash

# Script to do much of the heavy lifting when getting my home directory setup after cloning the dots from github. Little odds and ends that I might forget or am too lazy to do myself.

if [ "$SHELL" == "/bin/bash" ]; then

# Install preferred programs in pacman backup
sudo nano /etc/pacman.conf
sudo pacman -S --noconfirm $(cat ~/.cache/pacman-backup)

# Set default shell
chsh -s /usr/bin/zsh

# Connman preconfig
systemctl enable connman
systemctl start connman

# Gnupg permissions
chmod 700 ~/.config/gnupg

# Cleanup old bash stuff
rm -rf ~/.bash*

# Set default Git locations
mv ~/.gitignore ~/.config/gitignore
mv ~/.git ~/.local/git

# Create daily dirs
mkdir ~/docs > /dev/null
mkdir ~/downloads > /dev/null
mkdir ~/dev > /dev/null

# Install npm packages
export NPM_CONFIG_CACHE=~/.cache/npm
export NPM_CONFIG_PREFIX=~/.local/share/node_modules
npm install -g $(cat ~/.cache/npm-backup)

# prep man pages
sudo mandb

# Install cower and download aur backup
mkdir -p ~/.local/src/cower
wget -O ~/.local/src/cower/PKGBUILD "https://aur.archlinux.org/cgit/aur.git/plain/PKGBUILD?h=cower"
cd ~/.local/src/cower
makepkg -sri --skippgpcheck
cd ~
cower -df $(cat ~/.cache/aur-backup)

# final reminder
echo "Finished initial setup, remember to build all packages in ~/.local/src !"

fi
